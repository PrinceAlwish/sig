<html><head><title>Iwanyama-Rapid Live Collaborative Creativity</title><script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script><style>body{font-family:Arial,sans-serif;margin:0;padding:0;background:#f0f0f0}header{background:#4a90e2;color:white;padding:20px;text-align:center}#canvas{border:1px solid #ddd;background:white;margin:20px auto;display:block;cursor:crosshair;width:800px;height:600px}#controls{display:flex;justify-content:center;margin-bottom:20px}#controls button,#controls input{margin:0 10px;padding:10px;font-size:16px}#colorPicker{width:50px;height:50px}footer{text-align:center;padding:20px;background:#333;color:white}#userInfo{text-align:center;margin-bottom:10px}</style></head><body><header><h1>WebSim Draw</h1><p>The next-generation rapid live collaborative drawing tool for the interconnected mind</p></header><main><div id="userInfo">Your User ID: <span id="userId"></span></div><canvas id="canvas" width="200" height="150"></canvas><div id="controls"><button id="clear">Clear Canvas</button><input type="color" id="colorPicker" value="#000000"><input type="range" id="thickness" min="1" max="12" value="2"><button id="save">Save Artwork</button></div></main><footer><p>Â© 2023 WebSim Draw | <a href="https://gallery.websim.ai/">Explore WebSim Gallery</a> | <a href="https://collaborate.websim.ai/">Join Collaborative Projects</a></p></footer><script>const canvas=document.getElementById('canvas');const ctx=canvas.getContext('2d');ctx.scale(4,4);let isDrawing=false;let lastX=0;let lastY=0;ctx.lineJoin='round';ctx.lineCap='round';const gun=Gun(['https://gun-manhattan.herokuapp.com/gun']);const drawingData=gun.get('websim-draw').get('canvas-data');const userId=Math.random().toString(36).substr(2,9);document.getElementById('userId').textContent=userId;function draw(e){if(!isDrawing)return;const rect=canvas.getBoundingClientRect();const scaleX=canvas.width/rect.width;const scaleY=canvas.height/rect.height;const x=(e.clientX-rect.left)*scaleX/4;const y=(e.clientY-rect.top)*scaleY/4;const color=document.getElementById('colorPicker').value;const thickness=document.getElementById('thickness').value/4;drawLine(lastX,lastY,x,y,color,thickness);[lastX,lastY]=[x,y];storeArtwork();}function drawLine(fromX,fromY,toX,toY,color,thickness){ctx.beginPath();ctx.moveTo(fromX,fromY);ctx.lineTo(toX,toY);ctx.strokeStyle=color;ctx.lineWidth=thickness;ctx.stroke();}function drawDot(x,y,color,thickness){ctx.beginPath();ctx.arc(x,y,thickness/2,0,2*Math.PI);ctx.fillStyle=color;ctx.fill();}function storeArtwork(){const imageData=canvas.toDataURL();drawingData.put({imageData:imageData,timestamp:Date.now(),userId:userId});}canvas.addEventListener('mousedown',(e)=>{const rect=canvas.getBoundingClientRect();const scaleX=canvas.width/rect.width;const scaleY=canvas.height/rect.height;lastX=(e.clientX-rect.left)*scaleX/4;lastY=(e.clientY-rect.top)*scaleY/4;isDrawing=true;const color=document.getElementById('colorPicker').value;const thickness=document.getElementById('thickness').value/4;drawDot(lastX,lastY,color,thickness);storeArtwork();});canvas.addEventListener('mousemove',draw);canvas.addEventListener('mouseup',()=>{isDrawing=false;storeArtwork();});canvas.addEventListener('mouseout',()=>{isDrawing=false;storeArtwork();});document.getElementById('clear').addEventListener('click',()=>{ctx.clearRect(0,0,canvas.width/4,canvas.height/4);storeArtwork();});document.getElementById('save').addEventListener('click',()=>{const link=document.createElement('a');link.download='websim-masterpiece.png';link.href=canvas.toDataURL();link.click();});let lastUpdate=0;drawingData.on((data)=>{if(data&&data.timestamp>lastUpdate&&data.userId!==userId){const img=new Image();img.onload=function(){ctx.clearRect(0,0,canvas.width/4,canvas.height/4);ctx.drawImage(img,0,0,canvas.width/4,canvas.height/4);};img.src=data.imageData;lastUpdate=data.timestamp;}});</script></body></html>